const fs = require('fs');
const yaml = require('js-yaml');

const branch = process.env.BRANCH_NAME || 'main';
const url = `https://${branch}.jeimip.com`;

const doc = yaml.load(fs.readFileSync('./openapi.yaml', 'utf8'));

doc.servers = [{ url, description: 'Autogenerated by build script' }];

fs.writeFileSync('./openapi.yaml', yaml.dump(doc));
console.log(`ðŸ”§ Set server URL to ${url}`);
